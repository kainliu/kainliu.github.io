<!-- home > archives > notes > about > posts (null)--><!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>Arguments and Interface in Javascript | Westworld</title><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Asar|Imprima"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/5.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/images/blog-logo.png"><link rel="apple-touch-icon" href="/images/blog-logo.png"><link rel="apple-touch-icon-precomposed" href="/images/blog-logo.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div id="header"><div class="body_container"><div class="site-name"><h1 class="hidden">Arguments and Interface in Javascript</h1><a id="logo" href="/."><img src="/images/blog-logo.png" class="blog-logo nofancybox"><span>Westworld</span></a><p class="description"></p></div><div id="nav-menu"><a href="/"><i class="fa fa-rocket"> Home</i></a><a href="/archives/"><i class="fa fa-sitemap"> Archives</i></a><a href="/about/"><i class="fa fa-user-circle"> About</i></a></div></div></div><div id="layout" class="pure-g body_container"><div class="pure-u-1 pure-u-md-4-4"><div class="content_container"><div class="post"><div class="post-header"><div class="screen-wide-bg"><div class="post-header-container"><i class="post-thumbnail"><img src="/images/app.png" class="nofancybox"/></i><h1 class="post-title">Arguments and Interface in Javascript</h1><div class="post-desc">Some thoughts on designing Javascript function interface.</div><div class="post-meta"><span class="author">Kai</span><span class="date">2012-03-22</span></div></div></div></div><div class="post-content"><p>Let’s start with a simple function <code>person</code>:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">person</span>(<span class="params">name, sex, age</span>)</span>&#123;</span><br><span class="line">  <span class="comment">// use the variables</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line">person(<span class="string">"Lucy"</span>, <span class="string">"female"</span>, <span class="number">24</span>);</span><br></pre></td></tr></table></figure>
<p>If we want to add new parameters <code>height</code> and <code>weight</code>, we need to declare them one by one first:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// declare "height" and "weight"</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">person</span>(<span class="params">name, sex, age, height, weight</span>)</span>&#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// add "height" and "weight" at the tailer</span></span><br><span class="line">person(<span class="string">"Lucy"</span>, <span class="string">"female"</span>, <span class="number">24</span>, <span class="number">160</span>, <span class="number">50</span>);</span><br></pre></td></tr></table></figure>
<p>Adding more parameters leads to less comprehensibility. To make things worse, when working on fundamental toolkits, it’s possible that the sequential order of parameters can not be guaranteed.</p>
<p>Then, how to create a function with uncertain amount/order of parameters?</p>
<h3 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h3><p>Some say that JavaScript is a tricky language, and <code>arguments</code> is a tricky part of it.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">student</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"arguments : "</span> + <span class="built_in">arguments</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"first     : "</span> + <span class="built_in">arguments</span>[<span class="number">0</span>]);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">"last      : "</span> + <span class="built_in">arguments</span>[<span class="built_in">arguments</span>.length - <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line">student(<span class="string">"kevin"</span>, <span class="string">"john"</span>, <span class="string">"lucy"</span>);</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">arguments : [<span class="string">"kevin"</span>, <span class="string">"john"</span>, <span class="string">"lucy"</span>]</span><br><span class="line">first     : <span class="string">"kevin"</span></span><br><span class="line">last      : <span class="string">"lucy"</span></span><br></pre></td></tr></table></figure>
<p>It seems that <code>arguments</code> is an array(but actually it is not, explains afterwards), containing all parameters imported. With <code>arguments</code> introduced, we could make functions with uncertain parameters as following example.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">student</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> l = <span class="built_in">arguments</span>.length - <span class="number">1</span>; l &gt;= <span class="number">0</span> ; l--)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(l + <span class="string">" : "</span>+ <span class="built_in">arguments</span>[l]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">student(<span class="string">"kevin"</span>, <span class="string">"john"</span>, <span class="string">"lucy"</span>, <span class="string">"mike"</span>, <span class="string">"david"</span>);</span><br></pre></td></tr></table></figure>
<p>Output:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">4</span> : david</span><br><span class="line"><span class="number">3</span> : mike</span><br><span class="line"><span class="number">2</span> : lucy</span><br><span class="line"><span class="number">1</span> : john</span><br><span class="line"><span class="number">0</span> : kevin</span><br></pre></td></tr></table></figure>
<p>But when we use <code>pop</code> or <code>push</code> method to <code>arguments</code>:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">student</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">  <span class="comment">// try push</span></span><br><span class="line">  args.push(<span class="string">"lili"</span>);</span><br><span class="line">&#125;</span><br><span class="line">student(<span class="string">"kevin"</span>, <span class="string">"john"</span>, <span class="string">"lucy"</span>, <span class="string">"mike"</span>, <span class="string">"david"</span>);</span><br></pre></td></tr></table></figure>
<p>Output:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">TypeError: Object <span class="comment">#&lt;Object&gt; has no method 'push'</span></span><br></pre></td></tr></table></figure></p>
<p>It will throw an error – that means <code>arguments</code> is not an array but an Object quite similar. We should use a little trick here, to get a native array:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">student</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// use the natiave Array slice method. Now we get args as a standard array.</span></span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">    <span class="comment">// try push again</span></span><br><span class="line">    args.push(<span class="string">"lili"</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(args);</span><br><span class="line">&#125;</span><br><span class="line">student(<span class="string">"kevin"</span>, <span class="string">"john"</span>, <span class="string">"lucy"</span>, <span class="string">"mike"</span>, <span class="string">"david"</span>);</span><br></pre></td></tr></table></figure>
<p>Output:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[<span class="string">"kevin"</span>, <span class="string">"john"</span>, <span class="string">"lucy"</span>, <span class="string">"mike"</span>, <span class="string">"david"</span>, <span class="string">"lili"</span>]</span><br></pre></td></tr></table></figure></p>
<p>A more complicated version is a template <code>format</code> function:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">format</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> args = <span class="built_in">arguments</span>;</span><br><span class="line">    <span class="comment">// first item is template</span></span><br><span class="line">    <span class="keyword">var</span> template = args[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create regular expression, since we don't know how many parameters</span></span><br><span class="line">    <span class="comment">// are imported, use arguments.length as adaptive measurement.</span></span><br><span class="line">    <span class="keyword">var</span> pattern = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">"%([1-"</span> + <span class="built_in">arguments</span>.length + <span class="string">"])"</span>, <span class="string">"g"</span>);   </span><br><span class="line"></span><br><span class="line">    <span class="comment">// replace %N with the parameter sorted in the N</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(template).replace(pattern, <span class="function"><span class="keyword">function</span>(<span class="params">match, index</span>) </span>&#123;   </span><br><span class="line">        <span class="keyword">return</span> args[index];</span><br><span class="line">    &#125;);   </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">format(<span class="string">"%1 loves %3, %2 loves %3 too."</span>, <span class="string">"daddy"</span>, <span class="string">"mummy"</span>, <span class="string">"katty"</span>);</span><br></pre></td></tr></table></figure>
<p>Output:<br><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="string">"daddy loves katty, mummy loves katty too."</span></span><br></pre></td></tr></table></figure></p>
<p>The previous mode which puts every parameters in an array, we could call it <code>SEQUENCE</code>. Is it good enough?</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 2006-03-01: "name", "gender", "age"</span></span><br><span class="line">person(<span class="string">"Lucy"</span>, <span class="string">"female"</span>, <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2006-05-01: Add "height", "weight", "languages"</span></span><br><span class="line">person(<span class="string">"Lucy"</span>, <span class="string">"female"</span>, <span class="number">24</span>, <span class="number">160</span>, <span class="number">50</span>, <span class="string">"cantonese, mandarin"</span>);</span><br></pre></td></tr></table></figure>
<p>It really happens: with the booming of project, length of arguments increasing, the engineers are hard to distinguish parameters from each other. We could not know what they stand for unless referring to comments or looking into <code>person</code> function. Less self-explainable parameters make it hard to maintain.</p>
<h3 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h3><p>A better solution <code>JSON</code>:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Migrate to JSON</span></span><br><span class="line">person(&#123;</span><br><span class="line">  <span class="string">"name"</span> : <span class="string">"Lucy"</span>,</span><br><span class="line">  <span class="string">"sex"</span> : <span class="string">"female"</span>,</span><br><span class="line">  <span class="string">"age"</span> : <span class="number">24</span>,</span><br><span class="line">  <span class="string">"height"</span> : &#123;</span><br><span class="line">    <span class="string">"value"</span> : <span class="string">"160"</span>,</span><br><span class="line">    <span class="string">"unit"</span> : <span class="string">"cm"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"weight"</span> : &#123;</span><br><span class="line">    <span class="string">"value"</span> : <span class="string">"50"</span>,</span><br><span class="line">    <span class="string">"unit"</span> : <span class="string">"kg"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"languages"</span>: [<span class="string">"cantonese"</span>, <span class="string">"mandarin"</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>First benefit is that parameters become much more self-explainable, therefore developers do not need to dig into the function or even set breakpoints to find out their meanings then back to work.</p>
<p>What’s more, when adding a new parameter, there is no need to worry about the order.</p>
<h3 id="Interface"><a href="#Interface" class="headerlink" title="Interface"></a>Interface</h3><p>Unlike other OO program languages like <code>Java</code>, javascript does not have any built-in <code>interface</code>. Although the implementation of interface in javascript is still an arguable point, it is a very flexible language and could be applied with interface without much efforts.</p>
<p>Like <code>Interface</code> ensures the function has all required <code>methods</code>, the following class is used to ensure the called function contain all the necessary parameters, if not then throw an error.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Add 'validate' method to an object to be checked</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">$</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Store object</span></span><br><span class="line">  <span class="keyword">var</span> _$ = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.obj = obj</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// Bind method to prototype</span></span><br><span class="line">  _$.prototype.validate = <span class="function"><span class="keyword">function</span>(<span class="params">options</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> obj = <span class="keyword">this</span>.obj</span><br><span class="line">    <span class="comment">// loop default item</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i <span class="keyword">in</span> options)&#123;</span><br><span class="line">      <span class="comment">// the option is compulsive and when it's undefined</span></span><br><span class="line">      <span class="keyword">if</span>(options[i] === <span class="literal">true</span> &amp;&amp; obj[i] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"item: "</span> + i + <span class="string">" is UNDEFINED! Please check it."</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// return result</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.obj</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> _$(<span class="built_in">arguments</span>[<span class="number">0</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>For example, we use <code>validate</code> method to check <code>person</code>:    </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">jay = &#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"jay"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(jay).validate(&#123;</span><br><span class="line">  <span class="string">'name'</span>: <span class="literal">true</span></span><br><span class="line">  <span class="string">'sex'</span> : <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>It is definitely possible to enrich the validation functions:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// New a person object and apply validate method</span></span><br><span class="line">$(jay).validate(&#123;</span><br><span class="line">  <span class="comment">// Required + string</span></span><br><span class="line">  <span class="string">"name"</span> : [<span class="string">"required"</span>, <span class="string">"string"</span>],  </span><br><span class="line">  <span class="comment">// Required + only chosen from the options</span></span><br><span class="line">  <span class="string">"sex"</span>  : [<span class="string">"required"</span>, [<span class="string">"male"</span>,<span class="string">"female"</span>]],</span><br><span class="line">  <span class="comment">// Optional + integer</span></span><br><span class="line">  <span class="string">"age"</span>  : [<span class="string">"optional"</span>, <span class="string">"integer"</span>]  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Moreover, if we change the <code>return this.obj</code> with <code>return this</code> and add a new getter function, the methods could be applied in a chain style:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> candidate = $(jay).validate(&#123;...&#125;)</span><br><span class="line"><span class="keyword">var</span> age = candidate.get(<span class="string">'age'</span>)</span><br></pre></td></tr></table></figure>
<p>I will recommend <a href="http://www.google.com/#&amp;q=Pro+JavaScript+Design+Patterns" target="_blank" rel="noopener">Pro JavaScript Design Patterns</a> for its chapter on <code>interface</code> concept and comparison of design patterns, between other languages and javascript.</p>
</div><div class="post-meta"><div class="tags"><a href="/tags/javascript/">javascript</a><!-- tag.name--></div></div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><div><a data-url="http://westworld.name/posts/arguments-and-interface-in-javascript/" data-id="cjkq38by000025iqb8js5gbjs" class="article-share-link">Share</a></div><div id="disqus_show" class="readmore"><a class="show-comments" href="javascript:return false;"><span class="disqus-comment-count" data-disqus-identifier="posts/arguments-and-interface-in-javascript/"> Comments</span></a></div><div id="disqus_thread"></div><script>// Requires jQuery of course.
$(document).ready(function() {
    $('.show-comments').on('click', function(){
        var disqus_shortname = 'kaigithub';
        // ajax request to load the disqus javascript
        $.ajax({
                type: "GET",
                url: "//" + disqus_shortname + ".disqus.com/embed.js",
                dataType: "script",
                cache: true
        });
        // hide the button once comments load
        $(this).fadeOut();
    });
});
</script><script id="dsq-count-scr" src="//kaigithub.disqus.com/count.js" async></script><div id="post_nav_container" class="screen-wide-bg">  <div class="post-nav pure-u-1 pure-u-md-4-4"><div class="pure-u-md-1-2"><a href="/posts/behind-a-random-string-generator/" class="pre"><span>Behind A Random String Generator</span><i><img src="/images/coin.png" class="nofancybox"></i></a></div><div class="pure-u-md-1-2"> <a href="javascript:return false;" class="next no-more"><span>You are reading the oldest post</span><i><img src="/images/app.png" class="nofancybox"></i></a></div></div></div></div></div></div><div class="pure-u-1 pure-u-md-4-4"><div id="footer"><p>© <a href="/." rel="nofollow">Westworld.</a><span> Site Generated by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo. </a></span></p><p> <span> Theme modified from <a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo">Maupassant. </a></span><span>Icons from <a rel="nofollow" target="_blank" href="http://www.flaticon.com">Flaticon </a>are licensed by CC 3.0 BY.</span></p></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></body></html>